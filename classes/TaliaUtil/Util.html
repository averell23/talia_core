<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: TaliaUtil::Util</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href="../.././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">TaliaUtil::Util</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../../files/lib/talia_util/util_rb.html">
                lib/talia_util/util.rb
                </a>
        <br />
            </td>
        </tr>

        <tr class="top-aligned-row">
            <td><strong>Parent:</strong></td>
            <td>
                <a href="../Object.html">
                Object
               </a>
            </td>
        </tr>
        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <p>
Main utility functions for Talia
</p>

    </div>


   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000462">clear_data</a>&nbsp;&nbsp;
      <a href="#M000467">do_migrations</a>&nbsp;&nbsp;
      <a href="#M000470">fat_record_joins</a>&nbsp;&nbsp;
      <a href="#M000469">fat_record_select</a>&nbsp;&nbsp;
      <a href="#M000468">flag?</a>&nbsp;&nbsp;
      <a href="#M000460">flush_db</a>&nbsp;&nbsp;
      <a href="#M000461">flush_rdf</a>&nbsp;&nbsp;
      <a href="#M000463">full_reset</a>&nbsp;&nbsp;
      <a href="#M000454">get_files</a>&nbsp;&nbsp;
      <a href="#M000457">init_talia</a>&nbsp;&nbsp;
      <a href="#M000472">load_all_models</a>&nbsp;&nbsp;
      <a href="#M000466">load_fixtures</a>&nbsp;&nbsp;
      <a href="#M000473">load_models_from</a>&nbsp;&nbsp;
      <a href="#M000455">ontology_folder</a>&nbsp;&nbsp;
      <a href="#M000471">print_options</a>&nbsp;&nbsp;
      <a href="#M000465">rewrite_count</a>&nbsp;&nbsp;
      <a href="#M000464">rewrite_rdf</a>&nbsp;&nbsp;
      <a href="#M000456">setup_ontologies</a>&nbsp;&nbsp;
      <a href="#M000458">talia_config</a>&nbsp;&nbsp;
      <a href="#M000459">title</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->

    <div id="section">





      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Class methods</h3>

      <div id="method-M000462" class="method-detail">
        <a name="M000462"></a>

        <div class="method-heading">
          <a href="#M000462" class="method-signature">
          <span class="method-name">clear_data</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Remove the data directories. Removes the data directory (configured as
<tt>data_directory_location</tt> in talia_core.yml) and the iip directory
(configured as <tt>iip_root_location</tt> in talia_core.yml).
</p>
<p>
This ignores non-existing directories without an error message.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000462-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000462-source">
<pre>
     <span class="ruby-comment cmt"># File lib/talia_util/util.rb, line 141</span>
141:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">clear_data</span>
142:         <span class="ruby-identifier">data_dir</span> = <span class="ruby-constant">TaliaCore</span><span class="ruby-operator">::</span><span class="ruby-constant">CONFIG</span>[<span class="ruby-value str">'data_directory_location'</span>]
143:         <span class="ruby-identifier">iip_dir</span> = <span class="ruby-constant">TaliaCore</span><span class="ruby-operator">::</span><span class="ruby-constant">CONFIG</span>[<span class="ruby-value str">'iip_root_directory_location'</span>]
144:         <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">rm_rf</span>(<span class="ruby-identifier">data_dir</span>) <span class="ruby-keyword kw">if</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">exist?</span>(<span class="ruby-identifier">data_dir</span>))
145:         <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">rm_rf</span>(<span class="ruby-identifier">iip_dir</span>) <span class="ruby-keyword kw">if</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">exist?</span>(<span class="ruby-identifier">iip_dir</span>))
146:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000467" class="method-detail">
        <a name="M000467"></a>

        <div class="method-heading">
          <a href="#M000467" class="method-signature">
          <span class="method-name">do_migrations</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Runs the migrations for the main Talia tables. This will use the migrations
from the &quot;talia&quot; generator, <em>not</em> the ones from the Rails
application.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000467-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000467-source">
<pre>
     <span class="ruby-comment cmt"># File lib/talia_util/util.rb, line 228</span>
228:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">do_migrations</span>
229:         <span class="ruby-identifier">migration_path</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot;generators&quot;</span>, <span class="ruby-value str">&quot;talia&quot;</span>, <span class="ruby-value str">&quot;templates&quot;</span>, <span class="ruby-value str">&quot;migrations&quot;</span>)
230:         <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Migrator</span>.<span class="ruby-identifier">migrate</span>(<span class="ruby-identifier">migration_path</span>, <span class="ruby-constant">ENV</span>[<span class="ruby-value str">&quot;VERSION&quot;</span>] <span class="ruby-operator">?</span> <span class="ruby-constant">ENV</span>[<span class="ruby-value str">&quot;VERSION&quot;</span>].<span class="ruby-identifier">to_i</span> <span class="ruby-operator">:</span> <span class="ruby-keyword kw">nil</span> )
231:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000470" class="method-detail">
        <a name="M000470"></a>

        <div class="method-heading">
          <a href="#M000470" class="method-signature">
          <span class="method-name">fat_record_joins</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
SQL join snippet for selecting &quot;fat&quot; records. See <a
href="Util.html#M000469">fat_record_select</a>
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000470-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000470-source">
<pre>
     <span class="ruby-comment cmt"># File lib/talia_util/util.rb, line 258</span>
258:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">fat_record_joins</span>
259:         <span class="ruby-identifier">joins</span> =  <span class="ruby-value str">&quot; LEFT JOIN active_sources AS obj_sources ON semantic_relations.object_id = obj_sources.id AND semantic_relations.object_type = 'TaliaCore::ActiveSource'&quot;</span>
260:         <span class="ruby-identifier">joins</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot; LEFT JOIN semantic_properties AS obj_props ON semantic_relations.object_id = obj_props.id AND semantic_relations.object_type = 'TaliaCore::SemanticProperty'&quot;</span>
261:         <span class="ruby-identifier">joins</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot; LEFT JOIN active_sources AS subject_sources ON semantic_relations.subject_id = subject_sources.id&quot;</span>
262:         <span class="ruby-identifier">joins</span>
263:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000469" class="method-detail">
        <a name="M000469"></a>

        <div class="method-heading">
          <a href="#M000469" class="method-signature">
          <span class="method-name">fat_record_select</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
SQL select portion selecting &quot;fat&quot; records from the
semantic_relatations table. This will select all data needed to create all
triples. Used for rewriting the rdf.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000469-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000469-source">
<pre>
     <span class="ruby-comment cmt"># File lib/talia_util/util.rb, line 243</span>
243:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">fat_record_select</span>
244:         <span class="ruby-identifier">select</span> = <span class="ruby-value str">'semantic_relations.id AS id, semantic_relations.created_at AS created_at, '</span>
245:         <span class="ruby-identifier">select</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">'semantic_relations.updated_at AS updated_at, '</span>
246:         <span class="ruby-identifier">select</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">'object_id, object_type, subject_id, predicate_uri, '</span>
247:         <span class="ruby-identifier">select</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">'obj_props.created_at AS property_created_at, '</span>
248:         <span class="ruby-identifier">select</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">'obj_props.updated_at AS property_updated_at, '</span>
249:         <span class="ruby-identifier">select</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">'obj_props.value AS property_value, '</span>
250:         <span class="ruby-identifier">select</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">'obj_sources.created_at AS object_created_at, '</span>
251:         <span class="ruby-identifier">select</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">'obj_sources.updated_at AS object_updated_at, obj_sources.type AS  object_realtype, '</span>
252:         <span class="ruby-identifier">select</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">'obj_sources.uri AS object_uri, '</span>
253:         <span class="ruby-identifier">select</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">'subject_sources.uri AS subject_uri'</span>
254:         <span class="ruby-identifier">select</span>
255:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000468" class="method-detail">
        <a name="M000468"></a>

        <div class="method-heading">
          <a href="#M000468" class="method-signature">
          <span class="method-name">flag?</span><span class="method-args">(the_flag)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Check if the given flag is set on the command line. This will assert that
the flag is set, otherwise it&#8216;s equivalent to String#yes? (from the
core extensions) on the variable
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000468-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000468-source">
<pre>
     <span class="ruby-comment cmt"># File lib/talia_util/util.rb, line 236</span>
236:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">flag?</span>(<span class="ruby-identifier">the_flag</span>)
237:         <span class="ruby-identifier">assit_not_nil</span>(<span class="ruby-identifier">the_flag</span>)
238:         <span class="ruby-constant">ENV</span>[<span class="ruby-identifier">the_flag</span>].<span class="ruby-identifier">yes?</span>
239:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000460" class="method-detail">
        <a name="M000460"></a>

        <div class="method-heading">
          <a href="#M000460" class="method-signature">
          <span class="method-name">flush_db</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Flush the SQL database. This deletes all entries <b>only</b> from the main
Talia tables in the db. Additional tables for user-defined models (e.g.
translations) will <em>not</em> be touched.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000460-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000460-source">
<pre>
     <span class="ruby-comment cmt"># File lib/talia_util/util.rb, line 124</span>
124:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">flush_db</span>
125:         [ <span class="ruby-value str">'active_sources'</span>, <span class="ruby-value str">'data_records'</span>, <span class="ruby-value str">'semantic_properties'</span>, <span class="ruby-value str">'semantic_relations'</span>, <span class="ruby-value str">'workflows'</span>].<span class="ruby-identifier">reverse</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">connection</span>.<span class="ruby-identifier">execute</span> <span class="ruby-node">&quot;DELETE FROM #{f}&quot;</span> }
126:         <span class="ruby-comment cmt"># Also remove the &quot;unsaved cache&quot; for the wrappers (may be important during testing)</span>
127:         <span class="ruby-constant">TaliaCore</span><span class="ruby-operator">::</span><span class="ruby-constant">SemanticCollectionWrapper</span>.<span class="ruby-identifier">instance_variable_set</span>(<span class="ruby-value str">'@unsaved_source_cache'</span><span class="ruby-value str">'@unsaved_source_cache'</span>, {})
128:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000461" class="method-detail">
        <a name="M000461"></a>

        <div class="method-heading">
          <a href="#M000461" class="method-signature">
          <span class="method-name">flush_rdf</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Flush the RDF store. This clears the whole store, including triples that
were added through other means than the Talia API.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000461-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000461-source">
<pre>
     <span class="ruby-comment cmt"># File lib/talia_util/util.rb, line 132</span>
132:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">flush_rdf</span>
133:         <span class="ruby-constant">ActiveRDF</span><span class="ruby-operator">::</span><span class="ruby-constant">ConnectionPool</span>.<span class="ruby-identifier">write_adapter</span>.<span class="ruby-identifier">clear</span>
134:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000463" class="method-detail">
        <a name="M000463"></a>

        <div class="method-heading">
          <a href="#M000463" class="method-signature">
          <span class="method-name">full_reset</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Do a full reset of the data store. Equivalent to clearing the Talia SQL
tables, the RDF store and the data directories. This will re-initialize the
ontologies afterwards.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000463-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000463-source">
<pre>
     <span class="ruby-comment cmt"># File lib/talia_util/util.rb, line 152</span>
152:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">full_reset</span>
153:         <span class="ruby-identifier">flush_db</span>
154:         <span class="ruby-identifier">flush_rdf</span>
155:         <span class="ruby-identifier">clear_data</span>
156:         <span class="ruby-identifier">setup_ontologies</span>
157:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000454" class="method-detail">
        <a name="M000454"></a>

        <div class="method-heading">
          <a href="#M000454" class="method-signature">
          <span class="method-name">get_files</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Rake task helper. Get the list of files the <tt>files</tt> environment
variable (passed as <tt>file=[files]</tt>). Exits the runtime and prints an
error message if the variable is not set.
</p>
<p>
This returns a FileList object with all the files that match the pattern.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000454-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000454-source">
<pre>
    <span class="ruby-comment cmt"># File lib/talia_util/util.rb, line 14</span>
14:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">get_files</span>
15:         <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;Files given: #{ENV['files']}&quot;</span>
16:         <span class="ruby-keyword kw">unless</span>(<span class="ruby-constant">ENV</span>[<span class="ruby-value str">'files'</span>])
17:           <span class="ruby-identifier">puts</span>(<span class="ruby-value str">&quot;This task needs files to work. Pass them like this files='something/*.x'&quot;</span>)
18:           <span class="ruby-identifier">print_options</span>
19:           <span class="ruby-identifier">exit</span>(<span class="ruby-value">1</span>)
20:         <span class="ruby-keyword kw">end</span>
21: 
22:         <span class="ruby-constant">FileList</span>.<span class="ruby-identifier">new</span>(<span class="ruby-constant">ENV</span>[<span class="ruby-value str">'files'</span>])
23:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000457" class="method-detail">
        <a name="M000457"></a>

        <div class="method-heading">
          <a href="#M000457" class="method-signature">
          <span class="method-name">init_talia</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Init the talia core system. Use to initialize the system for the rake
tasks. This will just exit if the system is already initialized, e.g.
through Rails.
</p>
<p>
See the rake:talia_core help task for options supported. Options include
<tt>talia_root</tt>, <tt>environment</tt>, <tt>config</tt>,
<tt>reset_db</tt> and <tt>reset_rdf</tt>
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000457-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000457-source">
<pre>
     <span class="ruby-comment cmt"># File lib/talia_util/util.rb, line 63</span>
 63:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">init_talia</span>
 64:         <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">if</span>(<span class="ruby-constant">TaliaCore</span><span class="ruby-operator">::</span><span class="ruby-constant">Initializer</span>.<span class="ruby-identifier">initialized</span>)
 65: 
 66:         <span class="ruby-comment cmt"># If we have Rails installed, just call the Rails config </span>
 67:         <span class="ruby-comment cmt"># instead of running the manual init</span>
 68:         <span class="ruby-keyword kw">if</span>(<span class="ruby-keyword kw">defined?</span>(<span class="ruby-constant">RAILS_ROOT</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exist?</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-constant">RAILS_ROOT</span>, <span class="ruby-value str">'config'</span>, <span class="ruby-value str">'environment.rb'</span>)))
 69:           <span class="ruby-identifier">puts</span> <span class="ruby-value str">&quot;\nInitializing Talia through Rails&quot;</span>
 70:           <span class="ruby-identifier">load</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-constant">RAILS_ROOT</span>, <span class="ruby-value str">'config'</span>, <span class="ruby-value str">'environment.rb'</span>))
 71:         <span class="ruby-keyword kw">else</span>
 72: 
 73:           <span class="ruby-comment cmt"># If options are not set, the initializer will fall back to the internal default</span>
 74:           <span class="ruby-constant">TaliaCore</span><span class="ruby-operator">::</span><span class="ruby-constant">Initializer</span>.<span class="ruby-identifier">talia_root</span> = <span class="ruby-constant">ENV</span>[<span class="ruby-value str">'talia_root'</span>]
 75:           <span class="ruby-constant">TaliaCore</span><span class="ruby-operator">::</span><span class="ruby-constant">Initializer</span>.<span class="ruby-identifier">environment</span> = <span class="ruby-constant">ENV</span>[<span class="ruby-value str">'environment'</span>]
 76: 
 77:           <span class="ruby-identifier">config_file</span> = <span class="ruby-constant">ENV</span>[<span class="ruby-value str">'config'</span>] <span class="ruby-operator">?</span> <span class="ruby-constant">ENV</span>[<span class="ruby-value str">'config'</span>] <span class="ruby-operator">:</span> <span class="ruby-value str">'talia_core'</span>
 78: 
 79:           <span class="ruby-comment cmt"># run the initializer</span>
 80:           <span class="ruby-constant">TaliaCore</span><span class="ruby-operator">::</span><span class="ruby-constant">Initializer</span>.<span class="ruby-identifier">run</span>(<span class="ruby-identifier">config_file</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">config</span><span class="ruby-operator">|</span>
 81:             <span class="ruby-keyword kw">unless</span>(<span class="ruby-identifier">flag?</span>(<span class="ruby-value str">'no_standalone'</span>))
 82:               <span class="ruby-identifier">puts</span> <span class="ruby-value str">&quot;Always using standalone db from utilities.&quot;</span>
 83:               <span class="ruby-identifier">puts</span> <span class="ruby-value str">&quot;Give the no_standalone option to override it.&quot;</span>
 84:               <span class="ruby-identifier">config</span>[<span class="ruby-value str">'standalone_db'</span>] = <span class="ruby-value str">&quot;true&quot;</span>
 85:             <span class="ruby-keyword kw">end</span>
 86:           <span class="ruby-keyword kw">end</span>
 87:         <span class="ruby-keyword kw">end</span>
 88:         <span class="ruby-identifier">puts</span>(<span class="ruby-value str">&quot;\nTaliaCore initialized&quot;</span>)
 89: 
 90:         <span class="ruby-comment cmt"># # Flush the database if requested</span>
 91:         <span class="ruby-keyword kw">if</span>(<span class="ruby-identifier">flag?</span>(<span class="ruby-value str">'reset_db'</span>))
 92:           <span class="ruby-identifier">flush_db</span>
 93:           <span class="ruby-identifier">puts</span> <span class="ruby-value str">&quot;DB flushed&quot;</span>
 94:         <span class="ruby-keyword kw">end</span>
 95: 
 96:         <span class="ruby-comment cmt"># Flus the rdf if requested</span>
 97:         <span class="ruby-keyword kw">if</span>(<span class="ruby-identifier">flag?</span>(<span class="ruby-value str">'reset_rdf'</span>))
 98:           <span class="ruby-identifier">flush_rdf</span>
 99:           <span class="ruby-identifier">puts</span> <span class="ruby-value str">&quot;RDF flushed&quot;</span>
100:         <span class="ruby-keyword kw">end</span>
101:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000472" class="method-detail">
        <a name="M000472"></a>

        <div class="method-heading">
          <a href="#M000472" class="method-signature">
          <span class="method-name">load_all_models</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Force-loads all Talia related models. This will attempt to load all classes
in RAILS_ROOT/app/models and in
TALIA_CODE_ROOT/lib/talia_core/source_types.
</p>
<p>
Use this to make sure the whole hierarchy of ActiveSource subclasses is in
memory..
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000472-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000472-source">
<pre>
     <span class="ruby-comment cmt"># File lib/talia_util/util.rb, line 284</span>
284:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">load_all_models</span>
285:         <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@models_loaded</span>
286:         <span class="ruby-identifier">load_models_from</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-constant">RAILS_ROOT</span>, <span class="ruby-value str">'app'</span>, <span class="ruby-value str">'models'</span>, <span class="ruby-value str">'**'</span>, <span class="ruby-value str">'*.rb'</span>) <span class="ruby-keyword kw">if</span>(<span class="ruby-keyword kw">defined?</span> <span class="ruby-constant">RAILS_ROOT</span>)
287:         <span class="ruby-identifier">load_models_from</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-constant">TALIA_CODE_ROOT</span>, <span class="ruby-value str">'lib'</span>, <span class="ruby-value str">'talia_core'</span>, <span class="ruby-value str">'source_types'</span>,  <span class="ruby-value str">'**'</span>,  <span class="ruby-value str">'*.rb'</span>), <span class="ruby-value str">'TaliaCore::SourceTypes::'</span>
288:         <span class="ruby-constant">TaliaCore</span><span class="ruby-operator">::</span><span class="ruby-constant">Source</span>
289:         <span class="ruby-constant">TaliaCore</span><span class="ruby-operator">::</span><span class="ruby-constant">Collection</span>
290: 
291:         <span class="ruby-ivar">@models_loaded</span> = <span class="ruby-keyword kw">true</span>
292:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000466" class="method-detail">
        <a name="M000466"></a>

        <div class="method-heading">
          <a href="#M000466" class="method-signature">
          <span class="method-name">load_fixtures</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Load the database fixtures. This &quot;manually&quot; loads the database
fixtures for the Talia tables for the core unit tests. The fixtures are
those contained in the talia_core folder, <em>not</em> the ones from the
application&#8216;s tests.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000466-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000466-source">
<pre>
     <span class="ruby-comment cmt"># File lib/talia_util/util.rb, line 217</span>
217:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">load_fixtures</span>
218:         <span class="ruby-comment cmt"># fixtures = ENV['FIXTURES'] ? ENV['FIXTURES'].split(/,/) : Dir.glob(File.join(File.dirname(__FILE__), 'test', 'fixtures', '*.{yml,csv}'))  </span>
219:         <span class="ruby-identifier">fixtures</span> = [ <span class="ruby-value str">'active_sources'</span>, <span class="ruby-value str">'semantic_relations'</span>, <span class="ruby-value str">'semantic_properties'</span> <span class="ruby-value str">'data_records'</span>]
220:         <span class="ruby-identifier">fixtures</span>.<span class="ruby-identifier">reverse</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">connection</span>.<span class="ruby-identifier">execute</span> <span class="ruby-node">&quot;DELETE FROM #{f}&quot;</span> }
221:         <span class="ruby-identifier">fixtures</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">fixture_file</span><span class="ruby-operator">|</span>
222:           <span class="ruby-constant">Fixtures</span>.<span class="ruby-identifier">create_fixtures</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">'test'</span>, <span class="ruby-value str">'fixtures'</span>), <span class="ruby-constant">File</span>.<span class="ruby-identifier">basename</span>(<span class="ruby-identifier">fixture_file</span>, <span class="ruby-value str">'.*'</span>))  
223:         <span class="ruby-keyword kw">end</span>  
224:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000473" class="method-detail">
        <a name="M000473"></a>

        <div class="method-heading">
          <a href="#M000473" class="method-signature">
          <span class="method-name">load_models_from</span><span class="method-args">(dir, prefix='')</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Helper to load all classes from a given directory. This will attempt to
instanciate all classes found in the dir. The name of the class to be
instantiated will be taken from the file name, prepending the prefix (e.g.
&#8216;ModuleName::&#8217;) if set.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000473-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000473-source">
<pre>
     <span class="ruby-comment cmt"># File lib/talia_util/util.rb, line 297</span>
297:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">load_models_from</span>(<span class="ruby-identifier">dir</span>, <span class="ruby-identifier">prefix</span>=<span class="ruby-value str">''</span>)
298:         <span class="ruby-comment cmt"># Appends a file system directory separator to the directory if needed.</span>
299:         <span class="ruby-identifier">dir</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-identifier">dir</span>, <span class="ruby-value str">''</span>)
300:         <span class="ruby-constant">Dir</span>[<span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-identifier">dir</span>, <span class="ruby-value str">'**'</span>, <span class="ruby-value str">'*.rb'</span>)].<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span> 
301:           <span class="ruby-comment cmt"># For every rb file we try to gues and instantiate the contained class.</span>
302:           <span class="ruby-identifier">model_name</span> = <span class="ruby-identifier">f</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-node">/#{dir}|\.rb/</span>, <span class="ruby-value str">''</span>)
303:           <span class="ruby-keyword kw">begin</span>
304:             (<span class="ruby-identifier">prefix</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">model_name</span>).<span class="ruby-identifier">camelize</span>.<span class="ruby-identifier">constantize</span>
305:           <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">Exception</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
306:             <span class="ruby-comment cmt"># Errors at this point could be ignored, as there may be files that do not contain classes.</span>
307:             <span class="ruby-constant">TaliaCore</span>.<span class="ruby-identifier">logger</span>.<span class="ruby-identifier">warn</span> <span class="ruby-node">&quot;Could not load class #{(prefix + model_name).camelize}: #{e.message}&quot;</span>
308:           <span class="ruby-keyword kw">end</span>
309:         <span class="ruby-keyword kw">end</span>
310:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000455" class="method-detail">
        <a name="M000455"></a>

        <div class="method-heading">
          <a href="#M000455" class="method-signature">
          <span class="method-name">ontology_folder</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Gets the <tt><a href="Util.html#M000455">ontology_folder</a></tt>
environment variable, as passed to the rake task with
<tt>ontology_folder=[folder]</tt>
</p>
<p>
Defaults to <tt>RAILS_ROOT/ontologies</tt> if the variable is not set.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000455-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000455-source">
<pre>
    <span class="ruby-comment cmt"># File lib/talia_util/util.rb, line 30</span>
30:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">ontology_folder</span>
31:         <span class="ruby-constant">ENV</span>[<span class="ruby-value str">'ontology_folder'</span>] <span class="ruby-operator">||</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-constant">RAILS_ROOT</span>, <span class="ruby-value str">'ontologies'</span>)
32:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000471" class="method-detail">
        <a name="M000471"></a>

        <div class="method-heading">
          <a href="#M000471" class="method-signature">
          <span class="method-name">print_options</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Print the options for the rake tasks to the console.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000471-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000471-source">
<pre>
     <span class="ruby-comment cmt"># File lib/talia_util/util.rb, line 266</span>
266:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">print_options</span>
267:         <span class="ruby-identifier">puts</span> <span class="ruby-value str">&quot;\nGeneral options (not all options are valid for all tasks):&quot;</span>
268:         <span class="ruby-identifier">puts</span> <span class="ruby-value str">&quot;files=&lt;pattern&gt;     - Files for the task (a pattern to match the files)&quot;</span>
269:         <span class="ruby-identifier">puts</span> <span class="ruby-value str">&quot;talia_root=&lt;path&gt;   - Manually configure the TALIA_ROOT path&quot;</span>
270:         <span class="ruby-identifier">puts</span> <span class="ruby-value str">&quot;                      (default:autodetect)&quot;</span>
271:         <span class="ruby-identifier">puts</span> <span class="ruby-value str">&quot;reset_rdf={yes|no}  - Flush the RDF store (default:no)&quot;</span>
272:         <span class="ruby-identifier">puts</span> <span class="ruby-value str">&quot;reset_db={yes|no}   - Flush the database (default:no)&quot;</span>
273:         <span class="ruby-identifier">puts</span> <span class="ruby-value str">&quot;config=&lt;filename&gt;   - Talia configuration file (default: talia_core)&quot;</span>
274:         <span class="ruby-identifier">puts</span> <span class="ruby-value str">&quot;environment=&lt;env&gt;   - Environment for configuration (default: development)&quot;</span>
275:         <span class="ruby-identifier">puts</span> <span class="ruby-value str">&quot;data_dir=&lt;dir&gt;      - Directory for the data files&quot;</span>
276:         <span class="ruby-identifier">puts</span> <span class="ruby-value str">&quot;verbose={yes|no}    - Show some additional info&quot;</span>
277:         <span class="ruby-identifier">puts</span> <span class="ruby-value str">&quot;&quot;</span>
278:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000465" class="method-detail">
        <a name="M000465"></a>

        <div class="method-heading">
          <a href="#M000465" class="method-signature">
          <span class="method-name">rewrite_count</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
The number of triples that would be rewritten with <a
href="Util.html#M000464">rewrite_rdf</a>
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000465-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000465-source">
<pre>
     <span class="ruby-comment cmt"># File lib/talia_util/util.rb, line 210</span>
210:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">rewrite_count</span>
211:         <span class="ruby-constant">TaliaCore</span><span class="ruby-operator">::</span><span class="ruby-constant">SemanticRelation</span>.<span class="ruby-identifier">count</span> <span class="ruby-operator">+</span> <span class="ruby-constant">TaliaCore</span><span class="ruby-operator">::</span><span class="ruby-constant">ActiveSource</span>.<span class="ruby-identifier">count</span>
212:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000464" class="method-detail">
        <a name="M000464"></a>

        <div class="method-heading">
          <a href="#M000464" class="method-signature">
          <span class="method-name">rewrite_rdf</span><span class="method-args">(turn_off_safety=false) {|if(block_given?)| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Rewrite the RDF for the whole database. Erases the RDF store completely and
re-builds the graph from the data in the SQL tables.
</p>
<p>
*Warning:* This will <b>loose</b> all information contained in the RDF that
is not duplicated. This includes all SWICKY notebooks!
</p>
<p>
Unless the turn_off_safety flag is set, or the environment variable
<tt>i_know_what_i_am_doing</tt> is set to &quot;yes&quot;, this method will
print an error message and raise an exception.
</p>
<p>
For each triple written, this will yield to the block (if one is given)
without parameters. For progress reporting, the overall number of triples
that will be rewritten can be acquired with <a
href="Util.html#M000465">rewrite_count</a>
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000464-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000464-source">
<pre>
     <span class="ruby-comment cmt"># File lib/talia_util/util.rb, line 173</span>
173:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">rewrite_rdf</span>(<span class="ruby-identifier">turn_off_safety</span>=<span class="ruby-keyword kw">false</span>)
174:         <span class="ruby-keyword kw">unless</span>((<span class="ruby-constant">ENV</span>[<span class="ruby-value str">'i_know_what_i_am_doing'</span>].<span class="ruby-identifier">yes?</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">turn_off_safety</span>)
175:           <span class="ruby-identifier">puts</span> <span class="ruby-value str">&quot;WARNING: Rewriting the RDF will ERASE all data that does not come from the Talia API&quot;</span>
176:           <span class="ruby-identifier">puts</span> <span class="ruby-value str">&quot;This includes ALL SWICKY notebooks&quot;</span>
177:           <span class="ruby-identifier">puts</span> 
178:           <span class="ruby-identifier">puts</span> <span class="ruby-value str">&quot;To proceed run this task again, and give the following option:&quot;</span>
179:           <span class="ruby-identifier">puts</span> <span class="ruby-value str">&quot;i_know_what_i_am_doing=yes&quot;</span>
180:           <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-value str">&quot;Can't proceed without confirmation.&quot;</span>
181:         <span class="ruby-keyword kw">end</span>
182:         <span class="ruby-identifier">flush_rdf</span>
183:         <span class="ruby-comment cmt"># We'll get all data from single query.</span>
184:         <span class="ruby-identifier">fat_rels</span> = <span class="ruby-constant">TaliaCore</span><span class="ruby-operator">::</span><span class="ruby-constant">SemanticRelation</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>, <span class="ruby-identifier">:joins</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">fat_record_joins</span>,
185:         <span class="ruby-identifier">:select</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">fat_record_select</span>)
186:         <span class="ruby-identifier">fat_rels</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">rec</span><span class="ruby-operator">|</span>
187:           <span class="ruby-identifier">subject</span> = <span class="ruby-constant">N</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">rec</span>.<span class="ruby-identifier">subject_uri</span>)
188:           <span class="ruby-identifier">predicate</span> = <span class="ruby-constant">N</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">rec</span>.<span class="ruby-identifier">predicate_uri</span>)
189:           <span class="ruby-identifier">object</span> = <span class="ruby-keyword kw">if</span>(<span class="ruby-identifier">rec</span>.<span class="ruby-identifier">object_uri</span>)
190:             <span class="ruby-constant">N</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">rec</span>.<span class="ruby-identifier">object_uri</span>)
191:           <span class="ruby-keyword kw">else</span>
192:             <span class="ruby-identifier">rec</span>.<span class="ruby-identifier">property_value</span>
193:           <span class="ruby-keyword kw">end</span>
194:           <span class="ruby-constant">ActiveRDF</span><span class="ruby-operator">::</span><span class="ruby-constant">FederationManager</span>.<span class="ruby-identifier">add</span>(<span class="ruby-identifier">subject</span>, <span class="ruby-identifier">predicate</span>, <span class="ruby-identifier">object</span>)
195:           <span class="ruby-keyword kw">yield</span> <span class="ruby-keyword kw">if</span>(<span class="ruby-identifier">block_given?</span>)
196:         <span class="ruby-keyword kw">end</span>
197: 
198:         <span class="ruby-comment cmt"># Rewriting all the &quot;runtime type&quot; rdf triples</span>
199:         <span class="ruby-comment cmt"># We'll select the type as something else, so that it doesn't try to do</span>
200:         <span class="ruby-comment cmt"># STI instantiation (which would cause this to blow for classes that</span>
201:         <span class="ruby-comment cmt"># are defined outside the core.</span>
202:         <span class="ruby-constant">TaliaCore</span><span class="ruby-operator">::</span><span class="ruby-constant">ActiveSource</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>, <span class="ruby-identifier">:select</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'uri, type AS runtime_type'</span>).<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">src</span><span class="ruby-operator">|</span>
203:           <span class="ruby-identifier">type</span> = (<span class="ruby-identifier">src</span>.<span class="ruby-identifier">runtime_type</span> <span class="ruby-operator">||</span> <span class="ruby-value str">'ActiveSource'</span>)
204:           <span class="ruby-constant">ActiveRDF</span><span class="ruby-operator">::</span><span class="ruby-constant">FederationManager</span>.<span class="ruby-identifier">add</span>(<span class="ruby-identifier">src</span>, <span class="ruby-constant">N</span><span class="ruby-operator">::</span><span class="ruby-constant">RDF</span>.<span class="ruby-identifier">type</span>, <span class="ruby-constant">N</span><span class="ruby-operator">::</span><span class="ruby-constant">TALIA</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">type</span>)
205:           <span class="ruby-keyword kw">yield</span> <span class="ruby-keyword kw">if</span>(<span class="ruby-identifier">block_given?</span>)
206:         <span class="ruby-keyword kw">end</span>
207:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000456" class="method-detail">
        <a name="M000456"></a>

        <div class="method-heading">
          <a href="#M000456" class="method-signature">
          <span class="method-name">setup_ontologies</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Set up the ontologies from the <a
href="Util.html#M000455">ontology_folder</a>. This clears the RDF context
for the ontologies, if possible. Then it will load all ontologies in the <a
href="Util.html#M000455">ontology_folder</a> into the store, and run the
RdfUpdate::owl_to_rdfs update.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000456-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000456-source">
<pre>
    <span class="ruby-comment cmt"># File lib/talia_util/util.rb, line 38</span>
38:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">setup_ontologies</span>
39:         <span class="ruby-comment cmt"># Clear the ontologies from RDF, if possible</span>
40:         <span class="ruby-identifier">adapter</span> = <span class="ruby-constant">ActiveRDF</span><span class="ruby-operator">::</span><span class="ruby-constant">ConnectionPool</span>.<span class="ruby-identifier">write_adapter</span>
41:         <span class="ruby-keyword kw">if</span>(<span class="ruby-identifier">adapter</span>.<span class="ruby-identifier">contexts?</span>)
42:           <span class="ruby-constant">TaliaCore</span><span class="ruby-operator">::</span><span class="ruby-constant">RdfImport</span>.<span class="ruby-identifier">clear_file_contexts</span>
43:         <span class="ruby-keyword kw">else</span>
44:           <span class="ruby-identifier">puts</span> <span class="ruby-value str">&quot;WARNING: Cannot remove old ontologies, adapter doesn't support contexts.&quot;</span>
45:         <span class="ruby-keyword kw">end</span>
46: 
47:         <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;Ontologies loaded from: #{ontology_folder}&quot;</span>
48:         <span class="ruby-identifier">files</span> = <span class="ruby-constant">Dir</span>[<span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-identifier">ontology_folder</span>, <span class="ruby-value str">'*.{rdf*,owl}'</span>)]
49:         <span class="ruby-constant">ENV</span>[<span class="ruby-value str">'rdf_syntax'</span>] <span class="ruby-operator">||=</span> <span class="ruby-value str">'rdfxml'</span>
50:         <span class="ruby-identifier">params</span> = [<span class="ruby-constant">ENV</span>[<span class="ruby-value str">'rdf_syntax'</span>], <span class="ruby-identifier">files</span>]
51:         <span class="ruby-identifier">params</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">:auto</span> <span class="ruby-keyword kw">if</span>(<span class="ruby-identifier">adapter</span>.<span class="ruby-identifier">contexts?</span>)
52:         <span class="ruby-constant">TaliaCore</span><span class="ruby-operator">::</span><span class="ruby-constant">RdfImport</span><span class="ruby-operator">::</span><span class="ruby-identifier">import</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">params</span>)
53:         <span class="ruby-constant">RdfUpdate</span><span class="ruby-operator">::</span><span class="ruby-identifier">owl_to_rdfs</span>
54:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000458" class="method-detail">
        <a name="M000458"></a>

        <div class="method-heading">
          <a href="#M000458" class="method-signature">
          <span class="method-name">talia_config</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Rake helper. Prints the talia configuration to the console.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000458-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000458-source">
<pre>
     <span class="ruby-comment cmt"># File lib/talia_util/util.rb, line 105</span>
105:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">talia_config</span>
106:         <span class="ruby-identifier">puts</span> <span class="ruby-value str">&quot;Talia configuration&quot;</span>
107:         <span class="ruby-identifier">puts</span> <span class="ruby-value str">&quot;&quot;</span>
108:         <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;TALIA_ROOT: #{TALIA_ROOT}&quot;</span>
109:         <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;Environment: #{TaliaCore::CONFIG['environment']}&quot;</span>
110:         <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;Standalone DB: #{TaliaCore::CONFIG['standalone_db']}&quot;</span>
111:         <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;Data Directory: #{TaliaCore::CONFIG['data_directory_location']}&quot;</span>
112:         <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;Local Domain: #{N::LOCAL}&quot;</span>
113:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000459" class="method-detail">
        <a name="M000459"></a>

        <div class="method-heading">
          <a href="#M000459" class="method-signature">
          <span class="method-name">title</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Rake/Startup helper. Prints out the talia version/header to the the
console.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000459-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000459-source">
<pre>
     <span class="ruby-comment cmt"># File lib/talia_util/util.rb, line 116</span>
116:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">title</span>
117:         <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;\nTalia Digital Library system. Version: #{TaliaCore::Version::STRING}&quot;</span> 
118:         <span class="ruby-identifier">puts</span> <span class="ruby-value str">&quot;http://www.muruca.org/\n\n&quot;</span>
119:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>